{% extends 'base.html' %}

{% block title %}Scanner og Label Printing{% endblock %}

{% block content %}
<!--
SCANNER CONFIGURATION REFERENCE:
=================================

Hardware: Zebra MC330M Scanner
DataWedge Configuration:
- Endpoint: http://SERVER_IP:5000/api/scanner/data  
- Method: POST
- Format: {"barcode": "%SCAN"}
- Headers: Content-Type: application/json

Printer: Brother QL-810W
- API Endpoint: /api/print/label
- Test Endpoint: /api/print/test
- Supported formats: Sample labels, Container labels

System API Endpoints:
- Scanner data: POST /api/scanner/data
- Scanner test: POST /api/scanner/test  
- Print test: POST /api/print/test
- Print label: POST /api/print/label
- System info: GET /api/system/info
-->

<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <h2>Scanner & Label Printing</h2>
            <div class="alert alert-info" role="alert">
                <i class="fas fa-info-circle"></i> 
                Scan prøve stregkoder og udskriv labels. Systemet understøtter både manuel indtastning og direkte scanning.
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Scanner Panel -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-primary text-white">
                    <h5><i class="fas fa-barcode"></i> Prøve Scanner</h5>
                </div>
                <div class="card-body">
                    <div class="form-group mb-4">
                        <label for="manualBarcode" class="form-label">Stregkode:</label>
                        <div class="input-group">
                            <input type="text" class="form-control form-control-lg" id="manualBarcode" 
                                   placeholder="Scan eller indtast stregkode" autofocus>
                            <button class="btn btn-primary" id="scanButton">
                                <i class="fas fa-search"></i> Søg
                            </button>
                        </div>
                        <div class="form-text">Tryk Enter eller klik Søg for at finde prøven</div>
                    </div>
                    
                    <div id="scannerStatus" class="alert alert-secondary">
                        <i class="fas fa-info-circle"></i> Klar til scanning...
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results and Label Printing Panel -->
        <div class="col-lg-6 mb-4">
            <div class="card h-100">
                <div class="card-header bg-success text-white">
                    <h5><i class="fas fa-vial"></i> Prøve Information</h5>
                </div>
                <div class="card-body">
                    <div id="scanResults" class="d-none">
                        <div class="table-responsive">
                            <table class="table table-sm table-striped">
                                <tbody>
                                    <tr>
                                        <td><strong>ID:</strong></td>
                                        <td id="sampleId"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Beskrivelse:</strong></td>
                                        <td id="sampleDescription"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Stregkode:</strong></td>
                                        <td id="sampleBarcode" class="font-monospace"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Varenummer:</strong></td>
                                        <td id="samplePartNumber"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Type:</strong></td>
                                        <td id="sampleType"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Status:</strong></td>
                                        <td id="sampleStatus"></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Mængde:</strong></td>
                                        <td><span id="sampleAmount"></span> <span id="sampleUnit"></span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Lokation:</strong></td>
                                        <td id="sampleLocation"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="d-grid gap-2 mt-3">
                            <button class="btn btn-success btn-lg" id="printSampleButton">
                                <i class="fas fa-print"></i> Udskriv Prøve Label
                            </button>
                        </div>
                    </div>
                    
                    <div id="noResults" class="alert alert-light text-center">
                        <i class="fas fa-search text-muted mb-2" style="font-size: 2rem;"></i>
                        <p class="mb-0">Scan en stregkode for at se prøve information</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Printer Status Panel -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0"><i class="fas fa-print"></i> Label Printer Status</h5>
                    <button class="btn btn-light btn-sm" id="printTestButton">
                        <i class="fas fa-vial"></i> Test Print
                    </button>
                </div>
                <div class="card-body">
                    <div id="printerStatus" class="alert alert-secondary mb-0">
                        <i class="fas fa-check-circle"></i> Brother QL-810W printer klar til udskrivning
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!--
Scanner functions are loaded from scanner-functions.js
All scanner configuration details are documented in the HTML comments above.
-->
<script src="{{ url_for('static', filename='js/scanner-functions.js') }}"></script>
{% endblock %}